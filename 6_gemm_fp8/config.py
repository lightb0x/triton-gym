import triton

BLOCK_SIZE = 64
assert BLOCK_SIZE in [32, 64, 128]

MATMUL_CONFIGS = []

for bm, bn, bk, gm, ns, nw in [
    # 32 : 7 configs, all bf16
    # 64 : 3 configs, 1x bf16, 2x fp8
    # 128 : 3 configs, all fp8
    (128, 256, 64, 8, 3, 8),  # 64
    (64, 256, 32, 8, 4, 4),  # 32
    (128, 128, 32, 8, 4, 4),  # 32
    (128, 64, 32, 8, 4, 4),  # 32
    (64, 128, 32, 8, 4, 4),  # 32
    (128, 32, 32, 8, 4, 4),  # 32
    (64, 32, 32, 8, 5, 2),  # 32
    (32, 64, 32, 8, 5, 2),  # 32
    # # fp8 128
    # (128, 256, 128, 8, 3, 8),  # 128
    # (256, 128, 128, 8, 3, 8),  # 128
    # (256, 64, 128, 8, 4, 4),  # 128
    # (64, 256, 128, 8, 4, 4),  # 128
    # (128, 128, 128, 8, 4, 4),  # 128
    # # fp8 my 128
    (64, 64, 128, 8, 4, 4),
    (128, 32, 128, 8, 4, 4),
    (128, 64, 128, 8, 4, 8),
    # fp8 64
    (64, 64, 64, 8, 4, 4),  # 64
    (64, 128, 64, 8, 4, 4),  # 64
    (128, 32, 64, 8, 4, 4),  # 64
    (128, 64, 64, 8, 4, 4),  # 64
    (128, 128, 64, 8, 4, 8),  # 64
]:
    # block_size === BK
    if bk == BLOCK_SIZE:
        MATMUL_CONFIGS.append(
            triton.Config({"BM": bm, "BN": bn, "BK": bk}, num_stages=ns, num_warps=nw)
        )
